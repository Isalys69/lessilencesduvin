{% extends "base.html" %}
{% block content %}
<div class="text-center mt-5">
  <h2 class="fw-bold text-danger mb-3">Paiement annulÃ©</h2>
  <p class="lead mb-4">{{ message|safe }}</p>

  {% if current_user.is_authenticated %}
    <button id="btn-save-cart" class="btn btn-outline-dark px-4 mb-3">
      ğŸ’¾ Enregistrer mon panier
    </button>
  {% endif %}

  <div>
    <a href="{{ url_for('panier.index') }}" class="btn btn-outline-dark px-4">
      ğŸ›’ Revenir Ã  mon panier
    </a>
    <a href="{{ url_for('catalogue.index') }}" class="btn btn-dark px-4 ms-2">
      DÃ©couvrir d'autres vins
    </a>
  </div>

  <p id="save-msg" class="text-success fw-semibold mt-3" style="display:none;"></p>
</div>

<script>
  const saveBtn = document.getElementById('btn-save-cart');
  if (saveBtn) {
    saveBtn.addEventListener('click', () => {
      fetch('/panier/save_cart', { method: 'POST' })
        .then(res => res.json())
        .then(data => {
          document.getElementById('save-msg').textContent = data.message;
          document.getElementById('save-msg').style.display = 'block';
        })
        .catch(err => console.error('Erreur sauvegarde panier :', err));
    });
  }
</script>
{% endblock %}
