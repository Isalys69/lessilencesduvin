{% extends "base.html" %}
{% block content %}

<section class="container my-5">
  <h1 class="text-center mb-3">Vins {{ couleur }}</h1>
  <p class="text-center text-muted mb-5">
    {% if couleur == 'Rouge' %}
      D√©couvrez notre s√©lection de vins rouges, profonds et vibrants, choisis pour leur caract√®re et l‚Äô√©motion qu‚Äôils √©veillent.
    {% elif couleur == 'Blanc' %}
      D√©couvrez nos vins blancs, lumineux et pr√©cis, reflets de la puret√© et de la sinc√©rit√© des vignerons.
    {% elif couleur == 'de garde' %}
      D√©couvrez nos vins de garde, patin√©s par le temps, porteurs d‚Äôune m√©moire et d‚Äôune profondeur uniques.
    {% else %}
      D√©couvrez notre s√©lection de vins {{ couleur | lower }}, choisis pour leur authenticit√© et l‚Äô√©motion qu‚Äôils √©veillent.
    {% endif %}
  </p>

  <div class="row g-4 justify-content-center">
    {% for vin in vins %}
    <div class="col-md-4 col-sm-6 d-flex align-items-stretch">
      <div class="card h-100 shadow-sm border-0 text-center p-3">

        <!-- ‚úÖ Image centr√©e et proportionn√©e -->
        <div class="d-flex justify-content-center align-items-center" style="height: 360px;">
          <a 
            href="{{ url_for('vins.vin_detail', vin_id=vin.id) }}">
            <img src="{{ url_for('static', filename='img/vins/' ~ vin.photo) }}"
            alt="{{ vin.nom }}"
            class="img-fluid rounded"
            style="max-height: 340px; object-fit: contain;">
          </a>
        </div>

        <div class="card-body d-flex flex-column justify-content-between">
          <div>
            <h5 
              class="card-title fw-semibold">
              {{ vin.nom }} ({{ vin.annee }})
            </h5>

            <p class="text-muted mb-1"><em>{{ vin.domaine.nom }}</em></p>

          </div>

          <div class="mt-3 d-flex justify-content-between align-items-center">
            <strong>{{ "%.2f"|format(vin.prix) | replace('.', ',') }} ‚Ç¨</strong>
            
            {% set rupture = (vin.stock|int) <= 0 %}
            <button
              type="button"
              class="btn btn-dark px-4 mt-2 js-ajouter-panier {% if rupture %}disabled-btn{% endif %}"              
              data-vin-id="{{ vin.id }}"
              data-stock="{{ vin.stock }}"
              {% if rupture %}
                aria-disabled="true"
                data-disabled-reason="Ce vin est en rupture."
                title="Ce vin est en rupture."
              {% endif %}>
              üõí Ajouter au panier
            </button>          
          </div>
        </div>

      </div>
    </div>
    {% endfor %}
  </div>
</section>

{% endblock %}
